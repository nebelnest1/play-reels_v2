<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#000000">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <title>(1) Private Video Request</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><circle cx=%2250%22 cy=%2250%22 r=%2250%22 fill=%22%23ff0000%22/><path d=%22M35 30 L75 50 L35 70 Z%22 fill=%22%23ffffff%22/></svg>">

  <script>
  var APP_CONFIG = {
    domain: "https://jup9.com",
    mainExit_currentTab_zoneId: 10217421,
    mainExit_newTab_zoneId: 10217420,
    tabUnderClick_newTab_zoneId: 10557765,
    ageExit_currentTab_zoneId: 10557767,
    ageExit_newTab_zoneId: 10557766,
    autoexit_zoneId: 10217422,
    autoexit_timeToRedirect: 30,
    reverse_zoneId: 10217419,
    back_zoneId: 10217423,
    back_count: 8
  };
  </script>

  <style>
    * { box-sizing: border-box; outline: none; -webkit-tap-highlight-color: transparent; }
    html, body { margin: 0; padding: 0; width: 100%; height: 100%; background: #000; overflow: hidden; font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", "Segoe UI", Roboto, Helvetica, Arial, sans-serif; }

    .reels-wrapper { position: relative; width: 100%; height: 100%; display: flex; flex-direction: column; cursor: pointer; background: #000; }

    /* –í–∏–¥–µ–æ —Å–ª–æ–∏ */
    .video-layer {
      position: absolute; inset: 0; width: 100%; height: 100%; object-fit: cover; z-index: 0; background: #000;
      opacity: 0; transition: opacity 0.3s ease; pointer-events: none;
    }
    .video-layer.active { opacity: 1; z-index: 1; }

    /* –ë–ª—é—Ä (Stage 2) */
    .blur-overlay {
      position: absolute; inset: 0; z-index: 30;
      backdrop-filter: blur(12px) brightness(0.7);
      -webkit-backdrop-filter: blur(12px) brightness(0.7);
      display: none; flex-direction: column; align-items: center; justify-content: center;
      pointer-events: none;
    }

    .lock-badge {
      background: rgba(0, 0, 0, 0.4); border: 1px solid rgba(255, 255, 255, 0.2);
      backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
      padding: 24px 32px; border-radius: 28px;
      display: flex; flex-direction: column; align-items: center; gap: 14px;
      box-shadow: 0 15px 45px rgba(0,0,0,0.5); transform: translateZ(0);
    }
    .lock-icon-wrap { width: 50px; height: 50px; background: #fff; border-radius: 50%; display: flex; align-items: center; justify-content: center; }
    .lock-badge h2 { color: #fff; margin: 0; font-size: 18px; font-weight: 800; text-transform: uppercase; }
    .lock-badge p { color: rgba(255,255,255,0.9); margin: 0; font-size: 14px; text-align: center; }

    /* –ú–æ–¥–∞–ª–∫–∞ */
    .modal-overlay {
      position: fixed; inset: 0; z-index: 999;
      background: rgba(0, 0, 0, 0.6); backdrop-filter: blur(8px);
      display: none; align-items: center; justify-content: center;
      animation: fadeIn 0.2s ease-out;
    }
    .modal-box {
      background: #1c1c1e; width: 85%; max-width: 320px; border-radius: 14px; text-align: center;
      box-shadow: 0 20px 60px rgba(0,0,0,0.8); transform: scale(0.95);
      animation: popIn 0.2s forwards; overflow: hidden;
    }
    .modal-header { padding: 24px 16px 20px; }
    .modal-icon { font-size: 32px; margin-bottom: 12px; display: block; }
    .modal-title { color: #fff; font-size: 20px; font-weight: 700; margin-bottom: 8px; }
    .modal-text { color: #aeaeb2; font-size: 15px; line-height: 1.4; }
    .modal-actions { display: flex; border-top: 1px solid #38383a; }
    .modal-btn {
      flex: 1; padding: 18px; font-size: 17px; font-weight: 500;
      background: transparent; border: none; cursor: pointer; border-right: 1px solid #38383a;
    }
    .modal-btn:last-child { border-right: none; font-weight: 700; }
    .modal-btn:active { background: #2c2c2e; }
    .btn-stay { color: #0a84ff; }
    .btn-leave { color: #8e8e93; }

    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes popIn { from { transform: scale(0.95); opacity: 0; } to { transform: scale(1); opacity: 1; } }
    .shake { animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both; }
    @keyframes shake { 10%, 90% { transform: translate3d(-2px, 0, 0); } 20%, 80% { transform: translate3d(4px, 0, 0); } 30%, 50%, 70% { transform: translate3d(-6px, 0, 0); } 40%, 60% { transform: translate3d(6px, 0, 0); } }

    /* UI */
    .reels-ui { position: absolute; inset: 0; z-index: 40; display: flex; flex-direction: column; justify-content: space-between; pointer-events: none; background: linear-gradient(180deg, rgba(0,0,0,0.3) 0%, rgba(0,0,0,0) 20%, rgba(0,0,0,0) 80%, rgba(0,0,0,0.7) 100%); }
    .top-bar { padding: 50px 16px 20px; display: flex; justify-content: space-between; pointer-events: auto; }
    .back-area { padding: 20px; margin: -20px; cursor: pointer; display: flex; align-items: center; justify-content: center; pointer-events: auto; }
    .right-actions { position: absolute; right: 8px; bottom: 100px; display: flex; flex-direction: column; align-items: center; gap: 16px; pointer-events: auto; }
    .icon-circle { width: 44px; height: 44px; background: rgba(30, 30, 30, 0.65); border-radius: 50%; display: flex; align-items: center; justify-content: center; backdrop-filter: blur(2px); }
    .action-text { font-size: 12px; font-weight: 600; color: #fff; margin-top: 4px; }
    .bottom-info { padding: 16px; color: #fff; margin-right: 60px; pointer-events: auto; }
    .avatar { width: 32px; height: 32px; border-radius: 50%; background: #ff0050; border: 1px solid #fff; }
    .username { font-weight: 700; font-size: 15px; margin-bottom: 4px; }
    .desc { font-size: 14px; opacity: 0.95; line-height: 1.3; }

    /* –ê–Ω–∏–º–∞—Ü–∏–∏ —Å–≤–∞–π–ø–∞ */
    .slide-out-up { animation: slideOutUp 0.45s cubic-bezier(0.25, 1, 0.5, 1) forwards; }
    .slide-in-up { animation: slideInUp 0.45s cubic-bezier(0.25, 1, 0.5, 1) forwards; visibility: visible !important; z-index: 2 !important; }
    @keyframes slideOutUp { 0% { transform: translateY(0); } 100% { transform: translateY(-100%); } }
    @keyframes slideInUp { 0% { transform: translateY(100%); } 100% { transform: translateY(0); } }
    .swipe-hint { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 50; pointer-events: none; font-size: 50px; animation: hintMove 1.8s infinite; }
    @keyframes hintMove { 0% { transform: translate(-50%, 40px); opacity: 0; } 40% { opacity: 1; } 100% { transform: translate(-50%, -60px); opacity: 0; } }
  </style>
</head>

<body>

<div class="reels-wrapper" id="click-trap">
  <video id="v1" class="video-layer active" playsinline webkit-playsinline muted loop preload="auto"></video>
  <video id="v2" class="video-layer" playsinline webkit-playsinline muted loop preload="auto"></video>

  <div id="blur-layer" class="blur-overlay">
    <div class="lock-badge" id="lock-badge">
      <div class="lock-icon-wrap">
        <svg width="26" height="26" viewBox="0 0 24 24" fill="none" stroke="#000" stroke-width="2.5"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
      </div>
      <h2 id="t-title">Sensitive Content</h2>
      <p id="t-desc">Tap to unblur and continue</p>
    </div>
  </div>

  <div id="exit-modal" class="modal-overlay">
    <div class="modal-box">
      <div class="modal-header">
        <span class="modal-icon">‚ö†Ô∏è</span>
        <div class="modal-title" id="m-title">Wait!</div>
        <div class="modal-text" id="m-text">You are closing a private connection. Access will be lost.</div>
      </div>
      <div class="modal-actions">
        <button class="modal-btn btn-leave" id="btn-leave">Leave</button>
        <button class="modal-btn btn-stay" id="btn-stay">Stay</button>
      </div>
    </div>
  </div>

  <div id="swipe-hint" class="swipe-hint">üëÜ</div>

  <div class="reels-ui">
    <div class="top-bar">
      <div class="back-area" id="back-trigger">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5"><polyline points="15 18 9 12 15 6"></polyline></svg>
      </div>
      <div style="background:rgba(50,50,50,0.6); padding:6px 12px; border-radius:20px; color:#fff; font-size:13px;">Filters</div>
    </div>
    <div class="right-actions">
      <div class="action-btn"><div class="icon-circle"><svg width="24" height="24" viewBox="0 0 24 24" fill="white"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg></div><span class="action-text" id="ui-likes">93</span></div>
      <div class="action-btn"><div class="icon-circle"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"></path></svg></div><span class="action-text">Share</span></div>
      <div class="action-btn"><div class="icon-circle"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 4l-9.5 9.5a2.5 2.5 0 0 0 3.5 3.5l9.5-9.5"/><path d="M18 7L21 4" stroke-width="2.5"/><path d="M14 10L12 7" stroke-width="2"/><path d="M20 10L22 13" stroke-width="2"/><path d="M19.5 2.5l1 1-1 1-1-1 1-1z" fill="white" stroke="none"/></svg></div></div>
    </div>
    <div class="bottom-info">
      <div style="display:flex; align-items:center; gap:8px; margin-bottom:8px;">
        <div class="avatar" id="ui-avatar"></div>
        <div class="username" id="ui-username">@Sweet_Alice</div>
      </div>
      <div class="desc" id="ui-desc">Do you like my view? üòà <br>Check link in bio... üëá</div>
    </div>
  </div>
</div>

<!-- ===== –õ–û–ì–ò–ö–ê –õ–ï–ù–î–ê (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è) ===== -->
<script>
document.addEventListener("DOMContentLoaded", () => {
  // data
  const reelsData = [
    {},
    { user: "@Sweet_Alice", likes: "93", desc: "Do you like my view? üòà <br>Check link in bio... üëá", color: "#ff0050" },
    { user: "@Naughty_Kate", likes: "12.4k", desc: "Wait for the end... üí¶ <br>Link in bio!", color: "#0095f6" }
  ];

  // i18n
  const translations = {
    'en': { title: "Sensitive Content", desc: "Tap to unblur and continue", mTitle: "Wait!", mText: "You are closing a private connection. Access will be lost.", stay: "Stay", leave: "Leave" },
    'ru': { title: "–ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç", desc: "–ù–∞–∂–º–∏, —á—Ç–æ–±—ã —Å–º–æ—Ç—Ä–µ—Ç—å", mTitle: "–ü–æ–¥–æ–∂–¥–∏!", mText: "–í—ã –∑–∞–∫—Ä—ã–≤–∞–µ—Ç–µ –ø—Ä–∏–≤–∞—Ç–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ. –î–æ—Å—Ç—É–ø –±—É–¥–µ—Ç —É—Ç–µ—Ä—è–Ω.", stay: "–û—Å—Ç–∞—Ç—å—Å—è", leave: "–£–π—Ç–∏" },
    'es': { title: "Contenido sensible", desc: "Toca para desbloquear", mTitle: "¬°Espera!", mText: "Est√°s cerrando una conexi√≥n privada. Se perder√° el acceso.", stay: "Quedarse", leave: "Salir" },
    'de': { title: "Sensibler Inhalt", desc: "Zum Entsperren tippen", mTitle: "Warte!", mText: "Sie schlie√üen eine private Verbindung. Der Zugriff geht verloren.", stay: "Bleiben", leave: "Verlassen" },
    'fr': { title: "Contenu sensible", desc: "Appuyez pour d√©bloquer", mTitle: "Attendez !", mText: "Vous fermez une connexion priv√©e. L'acc√®s sera perdu.", stay: "Rester", leave: "Quitter" },
    'pt': { title: "Conte√∫do sens√≠vel", desc: "Toque para desbloquear", mTitle: "Espere!", mText: "Voc√™ est√° fechando uma conex√£o privada. O acesso ser√° perdido.", stay: "Ficar", leave: "Sair" },
    'ar': { title: "ŸÖÿ≠ÿ™ŸàŸâ ÿ≠ÿ≥ÿßÿ≥", desc: "ÿßÿ∂ÿ∫ÿ∑ ŸÑÿ•ŸÑÿ∫ÿßÿ° ÿßŸÑŸÇŸÅŸÑ", mTitle: "ÿßŸÜÿ™ÿ∏ÿ±!", mText: "ÿ£ŸÜÿ™ ÿ™ÿ∫ŸÑŸÇ ÿßÿ™ÿµÿßŸÑÿßŸã ÿÆÿßÿµÿßŸã. ÿ≥Ÿäÿ™ŸÖ ŸÅŸÇÿØÿßŸÜ ÿßŸÑŸàÿµŸàŸÑ.", stay: "ÿßŸÑÿ®ŸÇÿßÿ°", leave: "ÿßŸÑŸÖÿ∫ÿßÿØÿ±ÿ©" }
  };

  const userLang = (navigator.language || 'en').slice(0,2).toLowerCase();
  const t = translations[userLang] || translations.en;
  document.getElementById('t-title').innerText = t.title;
  document.getElementById('t-desc').innerText = t.desc;
  document.getElementById('m-title').innerText = t.mTitle;
  document.getElementById('m-text').innerText = t.mText;
  document.getElementById('btn-stay').innerText = t.stay;
  document.getElementById('btn-leave').innerText = t.leave;

  // elements
  const v1 = document.getElementById('v1');
  const v2 = document.getElementById('v2');
  const swipeHint = document.getElementById("swipe-hint");
  const blurLayer = document.getElementById("blur-layer");
  const lockBadge = document.getElementById("lock-badge");
  const wrapper = document.querySelector('.reels-wrapper');
  const backTrigger = document.getElementById("back-trigger");
  const exitModal = document.getElementById("exit-modal");

  const uiUser = document.getElementById('ui-username');
  const uiLikes = document.getElementById('ui-likes');
  const uiDesc = document.getElementById('ui-desc');
  const uiAvatar = document.getElementById('ui-avatar');

  // video src
  const urlParams = new URLSearchParams(window.location.search);
  const offerID = urlParams.get('v') || '1';
  const getPath = (index) => `./assets/videos/lend${offerID}/reels-${index}.mp4`;

  v1.src = getPath(1);
  v2.src = getPath(2);
  v2.muted = true;
  v2.preload = "auto";
  v2.load();

  v1.play().catch(()=>{});

  // state
  let stage = 1;        // 1 or 2
  let unlocked = false; // blur unlocked
  let isAnimating = false;
  let touchStartY = 0;

  // bridge wait (–ø—Ä–æ–ø—É—à –¥–æ–±–∞–≤–∏—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–∑–∂–µ)
  function callBridge(fnName) {
    const fn = window[fnName];
    if (typeof fn === "function") { fn(); return; }
    let tries = 0;
    const id = setInterval(() => {
      const f = window[fnName];
      if (typeof f === "function") { clearInterval(id); f(); }
      if (++tries > 40) clearInterval(id); // ~2s
    }, 50);
  }

  function triggerShake() {
    lockBadge.classList.remove('shake');
    void lockBadge.offsetWidth;
    lockBadge.classList.add('shake');
  }

  function unlockBlur() {
    unlocked = true;
    blurLayer.style.display = 'none';
  }

  function showBlur() {
    unlocked = false;
    blurLayer.style.display = 'flex';
  }

  function waitCanPlay(video, timeoutMs = 700) {
    return new Promise((resolve) => {
      if (video.readyState >= 3) return resolve(true);
      let done = false;
      const onCanPlay = () => { if (done) return; done = true; cleanup(); resolve(true); };
      const timer = setTimeout(() => { if (done) return; done = true; cleanup(); resolve(false); }, timeoutMs);
      const cleanup = () => {
        clearTimeout(timer);
        video.removeEventListener('canplay', onCanPlay);
        video.removeEventListener('canplaythrough', onCanPlay);
        video.removeEventListener('loadeddata', onCanPlay);
      };
      video.addEventListener('canplay', onCanPlay, { once: true });
      video.addEventListener('canplaythrough', onCanPlay, { once: true });
      video.addEventListener('loadeddata', onCanPlay, { once: true });
    });
  }

  async function doSwap() {
    if (isAnimating) return;
    isAnimating = true;

    swipeHint.style.display = 'none';

    // UI update
    const newData = reelsData[2];
    uiUser.innerText = newData.user;
    uiLikes.innerText = newData.likes;
    uiDesc.innerHTML = newData.desc;
    uiAvatar.style.backgroundColor = newData.color;

    // –∂–¥–∞—Ç—å –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ v2 -> —É–º–µ–Ω—å—à–∞–µ–º —á–µ—Ä–Ω—ã–π —Ñ–ª–µ—à
    await waitCanPlay(v2, 700);

    // –∑–∞—Ä–∞–Ω–µ–µ —Å—Ç–∞—Ä—Ç—É–µ–º (–µ—Å–ª–∏ –ø–æ–ª—É—á–∏—Ç—Å—è) –ø–æ–∫–∞ –æ–Ω–æ –µ—â–µ –Ω–µ active
    v2.play().then(() => { /* ok */ }).catch(()=>{});

    // animation
    v1.classList.add('slide-out-up');
    v2.classList.add('slide-in-up');

    setTimeout(() => {
      v1.pause();
      v1.classList.remove('active', 'slide-out-up');

      v2.classList.add('active');
      v2.classList.remove('slide-in-up');

      showBlur();

      stage = 2;
      isAnimating = false;
    }, 450);
  }

  // prewarm v2 on touchstart
  wrapper.addEventListener('touchstart', (e) => {
    touchStartY = e.changedTouches[0].screenY;
    // –ø–æ–ø—ã—Ç–∫–∞ ‚Äú–ø–æ–¥–æ–≥—Ä–µ–≤–∞‚Äù –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö webview
    v2.play().then(() => v2.pause()).catch(()=>{});
  }, { passive: true });

  wrapper.addEventListener('touchend', async (e) => {
    const touchEndY = e.changedTouches[0].screenY;
    const isSwipeUp = (touchStartY - touchEndY) > 50;
    if (!isSwipeUp) return;

    if (stage === 1) {
      // backfix –Ω—É–∂–µ–Ω –Ω–∞ –ø–µ—Ä–≤–æ–º —Å–≤–∞–π–ø–µ
      await doSwap();
      callBridge("triggerBackFix");
      return;
    }

    // stage2 swipe
    triggerShake();
  }, { passive: true });

  // click routing
  window.addEventListener("click", async (e) => {
    // –Ω–µ —Ç—Ä–æ–≥–∞–µ–º –∫–ª–∏–∫–∏ –ø–æ –º–æ–¥–∞–ª–∫–µ/—Å—Ç—Ä–µ–ª–∫–µ
    if (e.target.closest('#exit-modal') || e.target.closest('.back-area')) return;

    if (stage === 1) {
      // –Ω–µ –¥–∞–µ–º —É–ª–µ—Ç–µ—Ç—å –≤ mainExit
      e.preventDefault(); e.stopPropagation(); e.stopImmediatePropagation();
      await doSwap();
      callBridge("triggerBackFix");
      return;
    }

    // stage2: blur ON -> unlock only
    if (stage === 2 && !unlocked) {
      if (e.target.closest('#blur-layer') || e.target.closest('#lock-badge')) {
        e.preventDefault(); e.stopPropagation(); e.stopImmediatePropagation();
        unlockBlur();
        return;
      }
      // –∫–ª–∏–∫ –º–∏–º–æ –±–µ–π–¥–∂–∞ ‚Äî —Ç—Ä—è—Å–µ–º
      e.preventDefault(); e.stopPropagation(); e.stopImmediatePropagation();
      triggerShake();
      return;
    }

    // stage2: unlocked -> MAIN EXIT (—á–µ—Ä–µ–∑ –ø—Ä–æ–ø—É—à bridge)
    if (stage === 2 && unlocked) {
      e.preventDefault(); e.stopPropagation(); e.stopImmediatePropagation();
      callBridge("triggerMainExit");
    }
  }, true);

  // back arrow logic
  backTrigger.addEventListener("click", async (e) => {
    e.preventDefault(); e.stopPropagation();

    if (stage === 1) {
      await doSwap();
      callBridge("triggerBackFix");
      return;
    }
    exitModal.style.display = "flex";
  });

  // click outside modal closes it (–Ω–µ –º–µ—à–∞–µ–º bridge –Ω–∞ –∫–Ω–æ–ø–∫–∞—Ö)
  exitModal.addEventListener("click", (e) => {
    if (e.target === exitModal) exitModal.style.display = "none";
  });
});
</script>

<!-- ===== –¢–í–û–ô –ü–†–û–ü–£–®-–°–ö–†–ò–ü–¢ (–∫–∞–∫ —Ç—ã –ø—Ä–∏—Å–ª–∞–ª) ===== -->
<script>
(()=>{var e,t,n,r,o,a=Object.create,s=Object.defineProperty,i=Object.getOwnPropertyDescriptor,l=Object.getOwnPropertyNames,d=Object.getPrototypeOf,c=Object.prototype.hasOwnProperty,u=(t,n,r,a)=>{if(n&&"object"==typeof n||"function"==typeof n)for(let e of l(n))c.call(t,e)||e===r||s(t,e,{get:()=>n[e],enumerable:!(a=i(n,e))||a.enumerable});return t},m=(e,t,n)=>(n=null!=e?a(d(e)):{},u(!t&&e&&e.__esModule?n:s(n,"default",{value:e,enumerable:!0}),e)),y=(e={"src/landings/vanisher/locale/en.json"(e,t){t.exports={}}},function(){return t||(0,e[l(e)[0]])((t={exports:{}}).exports,t),t.exports}),w=(e=>(e.Error="Error",e.RangeError="RangeError",e.ReferenceError="ReferenceError",e.SecurityError="SecurityError",e.SyntaxError="SyntaxError",e.TypeError="TypeError",e.Unknown="Unknown",e))({}),g=(e=>(e.rejectionhandled="rejectionhandled",e.unhandledrejection="unhandledrejection",e))({}),h=((()=>{let n=window.syncMetric;var e;n?(window.addEventListener("error",e=>{var t;e.filename.includes("extension")||(t=`errorMessage: ${e.message}, lineNumber: ${e.lineno}, columnNumber: ${e.colno}, file: `+e.filename,e=e.error.name&&Object.values(w).includes(e.error.name)?e.error.name:"Unknown",n({event:"error",errorMessage:t,errorSubType:e,errorType:"JS"}))}),window.addEventListener("unhandledrejection",e=>{var t;"object"==typeof e.reason&&null!=(t=null==(t=e.reason)?void 0:t.stack)&&t.includes("extension")||(t="object"==typeof e.reason&&null!=(t=e.reason)&&t.message?e.reason.message:JSON.stringify(e.reason),e=e.type,e=Object.values(g).includes(e)?e:"Unknown",n({event:"unhandledRejection",errorMessage:t,errorSubType:e,errorType:"JS"}))}),"production-archive"!==((null==(e=document.querySelector("html"))?void 0:e.getAttribute("data-env"))||"")||Object.keys(APP_CONFIG).length||n({event:"error",errorMessage:"Empty APP_CONFIG",errorSubType:"EmptyAppConfig",errorType:"CUSTOM"})):console.log("Sync metric is not initialized")})(),async()=>{var e=navigator;if(!e.userAgentData)return"";try{var t=["platformVersion"];return(await e.userAgentData.getHighEntropyValues(t)).platformVersion}catch(e){return e instanceof Error&&window.syncMetric&&window.syncMetric({event:"error",errorMessage:e.message,errorType:"CUSTOM",errorSubType:"FetchPlatformVersion"}),""}}),v=()=>{if("undefined"!=typeof Intl&&"function"==typeof Intl.DateTimeFormat){var e=Intl.DateTimeFormat().resolvedOptions().timeZone;if(e)return e}return""},U=()=>(new Date).getTimezoneOffset(),N=t=>{let n=new URLSearchParams;return Object.keys(t).forEach(e=>{t[e]&&n.set(e,t[e])}),n},p=new URL(window.location.href),b={pz:null!=(r=p.searchParams.get("pz"))?r:"",tb:null!=(r=p.searchParams.get("tb"))?r:"",tb_reverse:null!=(r=p.searchParams.get("tb_reverse"))?r:"",ae:null!=(r=p.searchParams.get("ae"))?r:"",z:null!=(r=p.searchParams.get("z"))?r:"",var:null!=(r=p.searchParams.get("var"))?r:"",var_1:null!=(r=p.searchParams.get("var_1"))?r:"",var_2:null!=(r=p.searchParams.get("var_2"))?r:"",var_3:null!=(r=p.searchParams.get("var_3"))?r:"",b:null!=(r=p.searchParams.get("b"))?r:"",campaignid:null!=(r=p.searchParams.get("campaignid"))?r:"",abtest:null!=(r=p.searchParams.get("abtest"))?r:"",rhd:null!=(r=p.searchParams.get("rhd"))?r:"1",s:null!=(r=p.searchParams.get("s"))?r:"",ymid:null!=(r=p.searchParams.get("ymid"))?r:"",wua:null!=(r=p.searchParams.get("wua"))?r:"",use_full_list_or_browsers:null!=(r=p.searchParams.get("use_full_list_or_browsers"))?r:"",cid:null!=(r=p.searchParams.get("cid"))?r:"",geo:null!=(r=p.searchParams.get("geo"))?r:""},R=({passParamToParams:e,searchParams:a,windowUrl:o})=>(e.forEach(e=>{var{from:e,to:t,joinWith:n}=e;let r=Array.isArray(e)?e.map(e=>null!=(e=o.searchParams.get(e))?e:"").filter(Boolean).join(null!=n?n:""):null!=(n=o.searchParams.get(e))?n:"";r&&t.forEach(e=>{a.set(e,r)})}),a),f=async({zone:e,passParamToParams:t})=>{var n=v(),r=U(),a=(null==(a=document.querySelector("html"))?void 0:a.getAttribute("data-version"))||"",o=(null==(o=document.querySelector("html"))?void 0:o.getAttribute("data-landing-name"))||"",s=null!=(s=window.templateHash)?s:"",a=JSON.stringify({dataVer:a,landingName:o,templateHash:s}),o=btoa(a),s={pz:b.pz,tb:b.tb,tb_reverse:b.tb_reverse,ae:b.ae,ab2r:b.abtest||String(APP_CONFIG.abtest||"")};let i={ymid:null!=(a=b.var_1)?a:b.var,var:null!=(a=b.var_2)?a:b.z,var_3:b.var_3,b:b.b,campaignid:b.campaignid,click_id:b.s,rhd:b.rhd,os_version:await h(),btz:n.toString(),bto:r.toString(),cmeta:o};e&&(i.zoneid=e),Object.entries(s).forEach(([e,t])=>{t&&(i[e]=t)});a=N(i);return t?R({passParamToParams:t,searchParams:a,windowUrl:new URL(window.location.href)}):a},D=(t,n)=>{try{for(let e=0;e<n;e+=1)window.history.pushState(null,"Please wait...",t);var e=window.location.href;window.history.pushState(null,document.title,e),console.log(`Back initializated ${n} times with `+t)}catch(e){e instanceof Error&&window.syncMetric&&window.syncMetric({event:"error",errorMessage:e.message,errorType:"CUSTOM",errorSubType:"PushStateToHistory"})}},P=async t=>{var t=null==t?void 0:t.back;if(t){var{currentTab:n,pageUrl:r}=t;if(n){var t=null!=(t=t.count)?t:10,{origin:a,pathname:o}=window.location;let e=""+a+o;r?e=r:((e=(e=e.includes("index.html")?e.split("/index.html")[0]:e).includes("back.html")?e.split("/back.html")[0]:e).endsWith("/")&&(e=e.substring(0,e.length-1)),e+="/back.html");a=new URL(e),o=await f({zone:n.zoneId}),r=(n.url?o.set("url",n.url):n.domain&&n.zoneId&&(o.set("z",n.zoneId),o.set("domain",n.domain)),decodeURIComponent(a.toString()+"?"+o.toString()));D(r,t)}}},S=async(e,t,n)=>{t=t.includes("http")?t:"https://"+t,t=new URL(t+"/afu.php"),e=await f({zone:e.toString(),passParamToParams:n}),n=decodeURIComponent(t.toString()+"?"+e.toString());return console.log("URL generated:",n),n},E=({url:e})=>{window.location.replace(e)},$=({currentTabUrl:e,newTabUrl:t})=>{t?(t=window.open(t,"_blank"))&&(t.opener=null,e)&&document.addEventListener("visibilitychange",()=>{"visible"===document.visibilityState&&E({url:e})}):e&&E({url:e})},_=(e,t)=>{console.error(`${t||"Some exit"} was supposed to work, but some data about this type of exit was missed`,e)},T=async(t,n,r=!0)=>{var a,o=t[n].currentTab;if(console.log(n+" worked",t),o){let e;if(o.zoneId&&o.domain)return null!=(a=window.syncMetric)&&a.call(window,{event:n,exitZoneId:o.zoneId}),e=await S(o.zoneId,o.domain),r&&await P(t),E({url:e});if(o.url)return null!=(a=window.syncMetric)&&a.call(window,{event:n,exitZoneId:o.url}),e=o.url,r&&await P(t),E({url:e})}_(o,n)},I=async(n,r)=>{var a,o=n[r];if(console.log(r+" worked",n),o){var{currentTab:s,newTab:i}=o;let e;s&&(s.zoneId&&s.domain?(e=await S(s.zoneId,s.domain),null!=(a=window.syncMetric)&&a.call(window,{event:r,exitZoneId:s.zoneId})):s.url?e=s.url:_(o,r));let t;i&&(i.zoneId&&i.domain?(t=await S(i.zoneId,i.domain),null!=(a=window.syncMetric)&&a.call(window,{event:r,exitZoneId:i.zoneId})):i.url?t=i.url:_(o,r)),await P(n),void $({currentTabUrl:e,newTabUrl:t})}else _(o,r)},F=()=>"undefined"!=typeof APP_CONFIG||(document.body.innerHTML=`<p style="">LANDING CAN'T BE RENDERED. üîî PLEASE ADD CODE.</p>`,!1),B=["currentTab","newTab"],k=["zoneId","url"],A=a=>{if(F()){let{domain:s,videoCount:e,prizeName:t,prizeImg:n,...r}=a;return{videoCount:e,prizeName:t,prizeImg:n,...Object.entries(r).reduce((e,[t,n])=>{var r,[t,a,o]=t.split("_");return t&&(B.includes(a)?(r=a,k.includes(o)&&(e[t]={...e[t],[r]:{domain:"zoneId"===o?s:void 0,[o]:n}})):k.includes(a)?(r=a,e[t]={...e[t],currentTab:{domain:"zoneId"===r?s:void 0,[r]:n}}):(o=a,e[t]={...e[t],[o]:n})),e},{})}}},L=((async()=>{let s,i=A(APP_CONFIG);if(i){var l=null==i?void 0:i.autoexit;if(null!=l&&l.currentTab){let e=null!=(s=l.timeToRedirect)?s:90,t="visible"===document.visibilityState,n=!1,r=function(){"visible"===document.visibilityState?(t=!0,n&&T(i,"autoexit")):t=!1},a=()=>(document.addEventListener("visibilitychange",r),setTimeout(()=>{n=!0,t&&T(i,"autoexit")},1e3*e)),o=a();l=()=>{clearTimeout(o),document.removeEventListener("visibilitychange",r)};document.addEventListener("mousemove",l),document.addEventListener("click",l),document.addEventListener("scroll",l)}}})(),{key:"data-cs",value:"exclude"}),G=5184e3,q=async e=>{var t=await f({zone:e.toString()}),n=b.abtest||APP_CONFIG.abtest;return b.ymid&&t.set("var_2",b.ymid),e&&t.set("z",e),b.wua&&t.set("wua",b.wua),n&&(t.set("ab2",String(n)),t.set("ab2_ttl",""+G)),t.set("sw","./sw.js"),t.set("d",location.host),t},p=async({outDomain:n,pushDomain:r,pushZone:a,allowedNew:o,allowedPop:s,subscribedNew:i,subscribedPop:l})=>{var e;(async e=>{var t=await q(a);e.setAttribute(L.key,L.value),e.src=`https://${r}/hid.js?`+t,e.onload=function(e){e.zoneId=a,e.events.onPermissionDefault=function(){},e.events.onPermissionAllowed=async function(){o&&window.open(await S(o,n),"_blank"),i&&(window.location.href=await S(i,n))},e.events.onPermissionDenied=function(){},e.events.onAlreadySubscribed=async function(){i&&window.open(await S(i,n),"_blank"),l&&(window.location.href=await S(l,n))},e.events.onNotificationUnsupported=function(){}}})(null==(e=[document.documentElement,document.body].filter(Boolean).pop())?void 0:e.appendChild(document.createElement("script")))},z=((r=A(APP_CONFIG))&&null!=(n=null==(r=r.push)?void 0:r.currentTab)&&n.domain&&null!=(n=null==r?void 0:r.currentTab)&&n.zoneId&&p({outDomain:r.currentTab.domain,pushDomain:"vayxi.com",pushZone:r.currentTab.zoneId}),(async()=>{let r=A(APP_CONFIG);if(r){var e=null==r?void 0:r.reverse;let n=!1;null!=e&&e.currentTab&&(window.addEventListener("click",async()=>{try{var e,t;n||(e=window.location.pathname,t=""+e+window.location.search,await P(r),window.history.pushState(null,"",t),n=!0)}catch(e){e instanceof Error&&window.syncMetric&&window.syncMetric({event:"error",errorMessage:e.message,errorType:"CUSTOM",errorSubType:"Reverse"})}},{capture:!0}),window.addEventListener("popstate",()=>{T(r,"reverse",!1)}))}})(),()=>{var e=window.location.search,e=new URLSearchParams(e).get("lang"),t=navigator.language.split("-")[0];return e||t||"en"}),O={},x={},C=async(n,r)=>{let a=z();return O[a]&&o===r||(o=r,O[a]=(async()=>{try{var e=r?`${r}/${a}.json`:`./locales/${a}.json`,t=await fetch(e);if(t.ok&&200===t.status)return x[a]=!1,await t.json();throw new Error("Locale file not found: "+e)}catch(e){return e instanceof Error&&window.syncMetric&&(window.syncMetric({event:"error",errorMessage:e.message,errorType:"CUSTOM",errorSubType:"GetTranslations"}),console.error(`Error while loading translations`)),x[a]=!0,n()}})()),O[a]},H=e=>{var t=z();return o===e&&null!=(e=x[t])&&e},V=async()=>Promise.resolve().then(()=>m(y(),1)).then(e=>e.default),M=((async()=>{(async(e,r,t)=>{var n=z(),e=(document.documentElement.setAttribute("lang",n),await C(e,t));["ar","he","fa","ur","az","ku","ff","dv"].includes(n)&&!H(t)&&document.documentElement.setAttribute("dir","rtl")})(V)})(),"step");

/* INTEGRATION BRIDGE */
(async()=>{
  let s=A(APP_CONFIG);
  if(!s)return;
  window.triggerMainExit = async () => { await I(s, "mainExit"); };
  window.triggerAgeExit  = async () => { await I(s, "ageExit"); };
  window.triggerBackFix  = async () => { await P(s); };

  const btnStay = document.getElementById('btn-stay');
  if(btnStay) {
    btnStay.onclick = (e) => {
      e.stopPropagation(); e.preventDefault(); e.stopImmediatePropagation();
      if (window.syncMetric) { window.syncMetric({ event: "tabUnderClick", exitZoneId: APP_CONFIG.tabUnderClick_newTab_zoneId }); }

      const landParams = new URLSearchParams(window.location.search);
      landParams.set('restore', '2');
      const landUrl = window.location.pathname + '?' + landParams.toString();

      const currentParams = new URLSearchParams(window.location.search);
      currentParams.set('zoneid', APP_CONFIG.tabUnderClick_newTab_zoneId);
      const adUrl = `${APP_CONFIG.domain}/afu.php?${currentParams.toString()}`;

      const link = document.createElement('a');
      link.href = landUrl;
      link.target = "_blank";
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);

      setTimeout(() => { window.location.href = adUrl; }, 100);
    };
  }

  const btnLeave = document.getElementById('btn-leave');
  if(btnLeave) {
    btnLeave.onclick = async (e) => {
      e.stopPropagation(); e.stopImmediatePropagation();
      await I(s, "ageExit");
    };
  }
})()
})();

</script>

</body>
</html>
